<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Test</title>
</head>

<body>
    <video id="video" width="320" height="240" controls mute>
        <source src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
            type="video/mp4">
    </video>
    <script>
        /*
            MediaTrigger v.1.3
        */
        class MediaTrigger {

            constructor(params) {
                this.media = params.media;
                this.breakpoints = params.triggers;
                this.currentBreakpoint = 0;
                this._bindedCheck = this._check.bind(this);
            }

            _check() {
                this.ctime = this.media.currentTime;
                if (this.breakpoints[this.currentBreakpoint].triggerTime) {
                    if (this.ctime >= this.breakpoints[this.currentBreakpoint].triggerTime) {
                        this._triggerAction();
                    }
                } else if (this.breakpoints[this.currentBreakpoint].triggerPercent) {
                    if (this.breakpoints[this.currentBreakpoint].triggerPercent > 1) console.warn("[MediaTrigger] triggerPercents must be set between 0 and 1");
                    else if (this.ctime / this.media.duration >= this.breakpoints[this.currentBreakpoint].triggerPercent) {
                        this._triggerAction();
                    }
                };
            }

            _triggerAction() {
                this.breakpoints[this.currentBreakpoint].action();
                this.currentBreakpoint++;

                if (this.currentBreakpoint > this.breakpoints.length - 1) this.stop();
            }

            start() {
                this.currentBreakpoint = 0;
                var that = this;
                this.media.addEventListener('timeupdate', this._bindedCheck);
            }

            stop() {
                this.media.removeEventListener('timeupdate', this._bindedCheck);
            }
        }

        var mediaTrigger = new MediaTrigger(
            {
                media: document.getElementById('video'),
                triggers: [
                    {
                        triggerTime: 1.5, // In seconds
                        name: "Intro", // Optional
                        action: function () {
                            console.log('First trigger');
                        }
                    },
                    {
                        triggerPercent: .005, // Between 0 and 1 
                        action: function () {
                            console.log('Second trigger');
                        }
                    }
                ]
            });

        function startTracking() {
            video.play();
            mediaTrigger.start();
        }

        function stopTtracking() {
            video.pause();
            video.currentTime = 0;
            mediaTrigger.stop();
        }
    </script>
</body>

</html>